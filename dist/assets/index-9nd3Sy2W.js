import{r as i,k as $,l as _,c as l,a as t,j as q,t as u,w as C,d as R,v as j,x as M,F as k,f as W,_ as A,z as T,g as x,q as L,h as E,i as r}from"./index-BQYtG4s7.js";import{_ as H,a as O}from"./not-found-JlC-HFKX.js";import{l as U,S as m}from"./lodash-CKW68pZj.js";import"./_commonjsHelpers-Cpj98o6Y.js";const G={class:"flex justify-between items-center"},X={class:"flex items-center gap-2"},J={class:"text-[16px] text-[var(--subTextColor)] font-semibold"},P={class:"mt-[50px] text-[14px]"},Q={class:"max-h-[calc(100vh-312px)] overflow-y-auto"},Y={class:"w-full border-spacing-0 table-fixed"},Z={key:0},tt={key:1},et={class:"align-middle p-[16px]"},ot={class:"align-middle p-[16px]"},at={class:"align-middle p-[16px]"},nt={class:"align-middle p-[16px] flex items-center gap-[12px]"},st=["onClick"],lt={key:2},rt={colspan:"8",class:"relative h-[calc(100vh-327px)]"},it={class:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 opacity-50 text-center"},dt={class:"text-center"},ct={key:0,class:"fixed top-0 right-0 left-0 bottom-0 h-[100vh] flex justify-center items-center isolate z-50 animate-fadeIn"},ut={class:"h-[100vh] rounded-0 md:h-[380px] w-[623px] bg-[var(--bgColor2)] md:rounded-[16px] backdrop-blur-[70px] animate-fadeDown"},pt={class:"form__group flex flex-col flex-1 relative"},xt={class:"form__group flex flex-col flex-1 relative"},vt={__name:"index",setup(ht){const S="http://127.0.0.1:8000/api/client/data-warning",B="http://127.0.0.1:8000/api/admin/search-warning",D="http://127.0.0.1:8000/api/admin/create-warning",F="http://127.0.0.1:8000/api/admin/delete-warning",d=i(!1),n=i([]),c=i(0),f=$(),z=E(),s=i(f.query.search||""),p=i(!!s.value),h=i(!1);async function b(){try{d.value=!0;const o=await x.get(S);n.value=o.data.data,c.value=o.data.data.length}catch(o){console.log(o)}finally{d.value=!1}}async function v(o){try{d.value=!0;const e=o.trim();if(p.value=!!e,!e){await b(),p.value=!1;return}p.value=!0;const a=await x.get(`${B}?search=${encodeURIComponent(e)}`,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}});n.value=a.data.data,c.value=a.data.data.length}catch(e){console.error(e)}finally{d.value=!1}}const I=U.debounce(o=>{v(o)},400);_(s,o=>{I(o)}),_(()=>f.query.search,o=>{s.value=o||"",v(s.value)},{immediate:!0});async function N(){const o=s.value.trim()?{search:s.value.trim()}:{};z.replace({query:o})}async function V(o){if((await m.fire({title:"Bạn có chắc chắn muốn xoá?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#db2828",cancelButtonColor:"#ccc",confirmButtonText:"Xoá",cancelButtonText:"Huỷ"})).isConfirmed)try{const a=await x.post(F,{id:o},{headers:{Authorization:"Bearer "+localStorage.getItem("token")}});m.fire("Đã xoá thành công!",a.data.message,"success"),n.value=n.value.filter(y=>y.id!==o),c.value=n.value.length}catch(a){m.fire("Lỗi!",a.response?.data?.message||"Không thể xoá","error")}}function K(){h.value=!0,L(()=>{Validator({form:"#form-warning",formGroupSelector:".form__group",errorSelector:".form-message",rules:[Validator.isRequired("#warningTitle","Không được để trống"),Validator.isRequired("#warningContent","Không được để trống")],resetOnSubmit:!0,onSubmit:async function(o){try{const e=await x.post(D,o,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}});FuiToast.success("Tạo thành công"),await b(),c.value=n.value.length,g()}catch{FuiToast.error("Lỗi")}}})})}function g(){h.value=!1}function w(o){o.target.style.height="auto",o.target.style.height=o.target.scrollHeight+"px"}return(o,e)=>(r(),l(k,null,[t("div",G,[t("div",X,[e[2]||(e[2]=t("h2",{class:"font-bold text-[24px]"},"Danh sách cảnh báo",-1)),t("p",J,"(Có "+u(c.value)+" cảnh báo)",1)]),t("button",{onClick:K,class:"btn ml-[20px]"},e[3]||(e[3]=[t("span",null,[t("i",{class:"fa soloid fa-plus"})],-1),t("span",null," Thêm cảnh báo",-1)])),t("form",{onSubmit:C(N,["prevent"]),class:"max-w-[500px] w-full mr-0 mt-0 rounded-[16px] bg-[var(--bgColor3)] border border-[rgba(255,255,255,0.1)] flex items-center p-[5px] mx-auto"},[R(t("input",{type:"text",placeholder:"Kiểm tra số tài khoản ngân hàng...","onUpdate:modelValue":e[0]||(e[0]=a=>s.value=a),class:"flex-1 bg-transparent border-none outline-none pl-[19px] text-[var(--textColor)]"},null,512),[[j,s.value]]),e[4]||(e[4]=t("button",{class:"btn"},[t("img",{src:H,alt:"",class:"block md:hidden"}),t("span",{class:"hidden md:block"},"Tìm Kiếm")],-1))],32)]),t("div",P,[e[9]||(e[9]=M('<table class="w-full overflow-hidden rounded-t-[16px] border-spacing-0 table-fixed"><colgroup><col style="width:5%;"><col style="width:20%;"><col style="width:60%;"><col style="width:10%;"></colgroup><thead class="bg-[var(--bgColor3)]"><tr><th class="p-[16px] text-left">id</th><th class="p-[16px] text-left">Tiêu đề cảnh báo</th><th class="p-[16px] text-left">Nội dung cảnh báo</th><th class="p-[16px] text-left"></th></tr></thead></table>',1)),t("div",Q,[t("table",Y,[e[8]||(e[8]=t("colgroup",null,[t("col",{style:{width:"5%"}}),t("col",{style:{width:"20%"}}),t("col",{style:{width:"60%"}}),t("col",{style:{width:"10%"}})],-1)),d.value?(r(),l("tbody",Z,e[5]||(e[5]=[t("tr",null,[t("td",{colspan:"8",class:"relative h-[calc(100vh-327px)]"},[t("div",{class:"fui-loading-ring loading absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2"},[t("div"),t("div"),t("div"),t("div")])])],-1)]))):n.value.length?(r(),l("tbody",tt,[(r(!0),l(k,null,W(n.value,a=>(r(),l("tr",{key:a.id,class:"dashboard__table-bodyItem"},[t("td",et,"# "+u(a.id),1),t("td",ot,u(a.warningTitle),1),t("td",at,u(a.warningContent),1),t("td",nt,[t("span",{onClick:y=>V(a.id),class:"cursor-pointer text-[18px] text-[var(--redColor)]"},e[6]||(e[6]=[t("i",{class:"fa-solid fa-trash"},null,-1)]),8,st)])]))),128))])):(r(),l("tbody",lt,[t("tr",null,[t("td",rt,[t("div",it,[e[7]||(e[7]=t("img",{src:O,class:"h-[200px]"},null,-1)),t("span",dt,u(p.value&&!n.value.length?"Không có dữ liệu bạn cần tìm":"Không có dữ liệu"),1)])])])]))])])]),h.value?(r(),l("section",ct,[t("div",{onClick:g,class:"absolute top-0 right-0 left-0 bottom-0 bg-black/60 cursor-pointer z-[-1]"}),t("div",ut,[t("div",{class:"flex justify-between items-center h-[54px] py-[12px] px-[16px] border-b border-[#FFFFFF1A]"},[e[11]||(e[11]=t("div",{class:"text-[20px] font-semibold"},"Tạo nội dung cảnh báo",-1)),t("div",{onClick:g,class:"w-[30px] h-[30px] rounded-full bg-[var(--bgColor3)] flex justify-center items-center cursor-pointer transition-all duration-200 ease-linear hover:opacity-50"},e[10]||(e[10]=[t("img",{src:A,alt:"close icon",class:"pointer-events-none"},null,-1)]))]),t("form",{id:"form-warning",onSubmit:e[1]||(e[1]=C(()=>{},["prevent"])),class:"h-[calc(100vh-54px)] py-[8px] px-[16px] md:h-[calc(380px-54px)] overflow-auto modal__body"},[t("div",pt,[e[12]||(e[12]=t("label",{for:"warningTitle",class:"font-medium w-max"},[T("Tiêu đề cảnh báo "),t("span",{class:"text-[var(--redColor)]"},"*")],-1)),t("textarea",{placeholder:"Nhập tiêu đề cảnh báo",name:"warningTitle",id:"warningTitle",onInput:w,class:"py-[10px] px-[12px] rounded-[8px] bg-[var(--bgColor3)] border-none outline-none text-[var(--textColor)] resize-none h-16 overflow-hidden mb-6"},null,32),e[13]||(e[13]=t("p",{class:"form-message text-[14px] text-[var(--redColor)] absolute top-0 right-0"},null,-1))]),t("div",xt,[e[14]||(e[14]=t("label",{for:"warningContent",class:"font-medium w-max"},[T("Nội dung cảnh báo cảnh báo "),t("span",{class:"text-[var(--redColor)]"},"*")],-1)),t("textarea",{placeholder:"Nhập nội dung cảnh báo",name:"warningContent",id:"warningContent",onInput:w,class:"py-[10px] px-[12px] rounded-[8px] bg-[var(--bgColor3)] border-none outline-none text-[var(--textColor)] resize-none h-16 overflow-hidden mb-6"},null,32),e[15]||(e[15]=t("p",{class:"form-message text-[14px] text-[var(--redColor)] absolute top-0 right-0"},null,-1))]),e[16]||(e[16]=t("button",{type:"submit",class:"block mx-auto btn"},"Thêm mới",-1))],32)])])):q("",!0)],64))}};export{vt as default};
